function p(h,o){let l=h.length,s=o.length,e=Array(l+1).fill(null).map(()=>Array(s+1).fill(0));for(let t=1;t<=l;t++)for(let r=1;r<=s;r++)h[t-1]===o[r-1]?e[t][r]=e[t-1][r-1]+1:e[t][r]=Math.max(e[t-1][r],e[t][r-1]);let f=[],n=l,i=s;for(;n>0&&i>0;)h[n-1]===o[i-1]?(f.unshift(h[n-1]),n--,i--):e[n-1][i]>e[n][i-1]?n--:i--;return f}function c(h,o){let l=h.split(""),s=o.split(""),e=p(l,s),f=[],n=0,i=0,t=0;for(;n<l.length||i<s.length;){let r="";for(;n<l.length&&(t>=e.length||l[n]!==e[t]);)r+=l[n],n++;r&&f.push({type:"delete",value:r});let u="";for(;i<s.length&&(t>=e.length||s[i]!==e[t]);)u+=s[i],i++;u&&f.push({type:"insert",value:u});let g="";for(;t<e.length&&n<l.length&&i<s.length&&l[n]===e[t]&&s[i]===e[t];)g+=e[t],n++,i++,t++;g&&f.push({type:"equal",value:g})}return f}function m(h,o){let l=h.split(`
`),s=o.split(`
`),e=p(l,s),f=[],n=0,i=0,t=0,r=1,u=1;for(;n<l.length||i<s.length;){for(;n<l.length&&(t>=e.length||l[n]!==e[t]);)f.push({type:"delete",lineNumber:{old:r},content:l[n]}),n++,r++;for(;i<s.length&&(t>=e.length||s[i]!==e[t]);)f.push({type:"insert",lineNumber:{new:u},content:s[i]}),i++,u++;for(;t<e.length&&n<l.length&&i<s.length&&l[n]===e[t]&&s[i]===e[t];)f.push({type:"equal",lineNumber:{old:r,new:u},content:e[t]}),n++,i++,t++,r++,u++}return f}function d(h,o){let l=m(h,o),s=[],e=0;for(;e<l.length;){let f=l[e];if(f.type==="equal"){s.push(f),e++;continue}if(f.type==="delete"&&e+1<l.length&&l[e+1].type==="insert"){let n=f,i=l[e+1],t=c(n.content,i.content);s.push({...n,segments:t.filter(r=>r.type!=="insert")}),s.push({...i,segments:t.filter(r=>r.type!=="delete")}),e+=2}else s.push(f),e++}return s}function a(h){return{additions:h.filter(o=>o.type==="insert").length,deletions:h.filter(o=>o.type==="delete").length,unchanged:h.filter(o=>o.type==="equal").length}}export{c as diffChars,m as diffLines,d as diffLinesWithInline,a as getDiffStats};
