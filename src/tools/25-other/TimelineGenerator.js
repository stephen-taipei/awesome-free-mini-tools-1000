import{jsx as e,jsxs as i}from"react/jsx-runtime";import{useState as b,useRef as C,useMemo as G}from"react";import{useTranslation as L}from"react-i18next";import w from"../../components/ui/Button";import M from"../../components/ui/TextArea";function T(){const{t:l}=L(),[d,h]=b([{id:"1",date:"2024-01-01",title:"Start",description:"Project started"},{id:"2",date:"2024-06-01",title:"Milestone 1",description:"First release"}]),[o,c]=b({date:"",title:"",description:""}),v=C(null),m=G(()=>[...d].sort((t,a)=>t.date.localeCompare(a.date)),[d]),p=()=>{!o.date||!o.title||(h([...d,{...o,id:Date.now().toString()}]),c({date:"",title:"",description:""}))},N=t=>{h(d.filter(a=>a.id!==t))},y=()=>{if(!v.current)return;const t=new XMLSerializer().serializeToString(v.current),a=document.createElement("canvas"),n=a.getContext("2d"),s=new Image,k=Math.max(600,m.length*120+100),E=800;a.width=E,a.height=k,s.onload=()=>{if(n){n.fillStyle="white",n.fillRect(0,0,a.width,a.height),n.drawImage(s,0,0);const S=a.toDataURL("image/png"),g=document.createElement("a");g.href=S,g.download="timeline.png",g.click()}},s.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t)))},x=120,f=50,u=Math.max(600,m.length*x+100),r=400;return i("div",{className:"flex flex-col md:flex-row gap-6",children:[i("div",{className:"w-full md:w-1/3 space-y-6",children:[i("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm",children:[e("h3",{className:"font-semibold text-slate-700 mb-4",children:l("tools.timelineGenerator.addEvent")}),i("div",{className:"space-y-3",children:[i("div",{children:[e("label",{className:"block text-xs text-slate-500 mb-1",children:l("tools.timelineGenerator.date")}),e("input",{type:"date",value:o.date,onChange:t=>c({...o,date:t.target.value}),className:"input w-full"})]}),i("div",{children:[e("label",{className:"block text-xs text-slate-500 mb-1",children:l("tools.timelineGenerator.title")}),e("input",{type:"text",value:o.title,onChange:t=>c({...o,title:t.target.value}),className:"input w-full"})]}),i("div",{children:[e("label",{className:"block text-xs text-slate-500 mb-1",children:l("tools.timelineGenerator.description")}),e(M,{value:o.description,onChange:t=>c({...o,description:t.target.value}),rows:2})]}),e(w,{onClick:p,className:"w-full",children:l("tools.timelineGenerator.add")})]})]}),i("div",{className:"bg-white p-4 rounded-lg border border-slate-200 shadow-sm max-h-[400px] overflow-y-auto",children:[e("h3",{className:"font-semibold text-slate-700 mb-4",children:l("tools.timelineGenerator.eventList")}),e("div",{className:"space-y-2",children:m.map(t=>i("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded border border-slate-100",children:[i("div",{className:"min-w-0",children:[e("div",{className:"text-sm font-medium text-slate-800",children:t.title}),e("div",{className:"text-xs text-slate-500",children:t.date})]}),e("button",{onClick:()=>N(t.id),className:"text-slate-400 hover:text-red-500 p-1",children:e("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t.id))})]})]}),i("div",{className:"flex-1 min-w-0",children:[e("div",{className:"flex justify-end mb-4",children:e(w,{variant:"secondary",onClick:y,children:l("common.download")})}),e("div",{className:"border border-slate-200 rounded-lg bg-white overflow-hidden shadow-inner overflow-x-auto",children:i("svg",{ref:v,width:"800",height:u,className:"mx-auto bg-white",children:[e("line",{x1:r,y1:f,x2:r,y2:u-50,stroke:"#cbd5e1",strokeWidth:"2"}),m.map((t,a)=>{const n=f+a*x,s=a%2===0;return i("g",{children:[e("circle",{cx:r,cy:n,r:"6",fill:"#3b82f6",stroke:"white",strokeWidth:"2"}),i("g",{transform:`translate(${s?r-20:r+20}, ${n})`,children:[e("rect",{x:s?-130:0,y:"-15",width:"130",height:"30",rx:"15",fill:"#3b82f6"}),e("text",{x:s?-65:65,y:"5",textAnchor:"middle",fill:"white",fontSize:"12",fontWeight:"bold",children:t.date}),e("text",{x:s?-150:150,y:"5",textAnchor:s?"end":"start",fill:"#1e293b",fontSize:"16",fontWeight:"bold",children:t.title}),e("text",{x:s?-150:150,y:"25",textAnchor:s?"end":"start",fill:"#64748b",fontSize:"14",children:t.description})]})]},t.id)})]})})]})]})}export{T as default};
