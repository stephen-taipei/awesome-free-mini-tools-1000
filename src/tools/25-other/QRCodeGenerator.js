import{jsx as l,jsxs as a}from"react/jsx-runtime";import{useState as v,useRef as I,useEffect as g}from"react";import{useTranslation as R}from"react-i18next";import h from"../../components/ui/Button";const S=(s,o=21)=>{const d=Array(o).fill(null).map(()=>Array(o).fill(!1)),f=(t,n)=>{for(let c=0;c<7;c++)for(let i=0;i<7;i++){const u=c===0||c===6||i===0||i===6,p=c>=2&&c<=4&&i>=2&&i<=4;d[n+c][t+i]=u||p}};f(0,0),f(o-7,0),f(0,o-7);for(let t=8;t<o-8;t++)d[6][t]=t%2===0,d[t][6]=t%2===0;let r=0;const b=new TextEncoder().encode(s);for(let t=o-1;t>=0;t-=2){t===6&&(t=5);for(let n=o-1;n>=0;n--)if(!(n<8&&t<8||n>=o-8&&t<8||n<8&&t>=o-8)&&!(n===6||t===6))if(r<b.length*8){const c=Math.floor(r/8),i=7-r%8;d[t][n]=(b[c]>>i&1)===1,r++}else d[t][n]=(n+t)%3===0}return d};function B(){const{t:s}=R(),o=I(null),[d,f]=v("https://example.com"),[r,b]=v(256),[t,n]=v("#000000"),[c,i]=v("#ffffff"),[u,p]=v([]),N=25;g(()=>{if(d.trim()){const e=S(d,N);p(e)}},[d]),g(()=>{if(!o.current||u.length===0)return;const e=o.current,m=e.getContext("2d");if(!m)return;e.width=r,e.height=r;const x=r/u.length;m.fillStyle=c,m.fillRect(0,0,r,r),m.fillStyle=t,u.forEach((w,k)=>{w.forEach((q,E)=>{q&&m.fillRect(E*x,k*x,x,x)})})},[u,r,t,c]);const C=()=>{if(!o.current)return;const e=document.createElement("a");e.download="qrcode.png",e.href=o.current.toDataURL("image/png"),e.click()},y=async()=>{if(o.current)try{const e=await new Promise(m=>{o.current.toBlob(x=>m(x),"image/png")});await navigator.clipboard.write([new ClipboardItem({"image/png":e})])}catch(e){console.error("Failed to copy:",e)}};return a("div",{className:"flex flex-col gap-4",children:[a("div",{className:"flex gap-2 flex-wrap items-center",children:[l("div",{className:"flex gap-1",children:[{label:"URL",value:"https://example.com"},{label:"Email",value:"mailto:hello@example.com"},{label:"Phone",value:"tel:+1234567890"},{label:"SMS",value:"sms:+1234567890?body=Hello"},{label:"WiFi",value:"WIFI:T:WPA;S:NetworkName;P:Password;;"},{label:"vCard",value:`BEGIN:VCARD
VERSION:3.0
N:Doe;John
TEL:+1234567890
END:VCARD`}].map(e=>l("button",{onClick:()=>f(e.value),className:"px-2 py-1 text-xs rounded bg-slate-100 hover:bg-slate-200 text-slate-600",children:e.label},e.label))}),l("div",{className:"flex-1"}),l(h,{variant:"secondary",onClick:y,children:s("common.copy")}),l(h,{variant:"secondary",onClick:C,children:s("common.download")})]}),a("div",{className:"flex gap-4",children:[a("div",{className:"flex-1 flex flex-col gap-4",children:[a("div",{children:[l("label",{className:"block text-sm text-slate-600 mb-1",children:s("tools.qrCode.content")}),l("textarea",{value:d,onChange:e=>f(e.target.value),placeholder:s("tools.qrCode.placeholder"),className:"input w-full h-32 resize-none font-mono text-sm"})]}),l("div",{className:"flex justify-center p-8 border border-slate-200 rounded-lg bg-slate-50",children:l("canvas",{ref:o,style:{width:r,height:r,maxWidth:"100%"},className:"shadow-lg"})})]}),a("div",{className:"w-64 border border-slate-200 rounded-lg bg-white p-4 flex flex-col gap-4",children:[l("h3",{className:"font-semibold text-slate-700",children:s("tools.qrCode.settings")}),a("div",{className:"space-y-4",children:[a("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:[s("tools.qrCode.size")," (",r,"px)"]}),l("input",{type:"range",min:"128",max:"512",step:"32",value:r,onChange:e=>b(parseInt(e.target.value)),className:"w-full"})]}),a("div",{children:[l("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.qrCode.foreground")}),a("div",{className:"flex gap-2 items-center",children:[l("input",{type:"color",value:t,onChange:e=>n(e.target.value),className:"w-10 h-8 rounded cursor-pointer"}),l("input",{type:"text",value:t,onChange:e=>n(e.target.value),className:"input flex-1 text-xs font-mono"})]})]}),a("div",{children:[l("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.qrCode.background")}),a("div",{className:"flex gap-2 items-center",children:[l("input",{type:"color",value:c,onChange:e=>i(e.target.value),className:"w-10 h-8 rounded cursor-pointer"}),l("input",{type:"text",value:c,onChange:e=>i(e.target.value),className:"input flex-1 text-xs font-mono"})]})]}),a("div",{className:"flex gap-2",children:[l("button",{onClick:()=>{n("#000000"),i("#ffffff")},className:"flex-1 px-2 py-1 text-xs rounded bg-slate-100 hover:bg-slate-200",children:s("tools.qrCode.reset")}),l("button",{onClick:()=>{const e=t;n(c),i(e)},className:"flex-1 px-2 py-1 text-xs rounded bg-slate-100 hover:bg-slate-200",children:s("tools.qrCode.invert")})]})]}),a("div",{className:"mt-auto pt-4 border-t border-slate-200",children:[l("h4",{className:"text-xs font-medium text-slate-500 mb-2",children:s("tools.qrCode.info")}),a("div",{className:"space-y-1 text-xs text-slate-500",children:[a("div",{children:[s("tools.qrCode.chars"),": ",d.length]}),a("div",{children:[s("tools.qrCode.bytes"),": ",new TextEncoder().encode(d).length]})]})]})]})]})]})}export{B as default};
