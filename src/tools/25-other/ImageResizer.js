import{Fragment as y,jsx as a,jsxs as t}from"react/jsx-runtime";import{useState as d,useRef as j}from"react";import{useTranslation as U}from"react-i18next";import z from"../../components/ui/Button";function B(){const{t:s}=U(),v=j(null),[o,k]=d(null),[l,C]=d({width:0,height:0}),[m,r]=d(0),[c,g]=d(0),[u,f]=d(!0),[x,w]=d("pixels"),[b,N]=d(100),[h,I]=d("png"),[p,M]=d(.9),$=e=>{const i=e.target.files?.[0];if(!i)return;const n=new Image;n.onload=()=>{k(n),C({width:n.width,height:n.height}),r(n.width),g(n.height),N(100)},n.src=URL.createObjectURL(i)},E=e=>{if(r(e),u&&l.width>0){const i=l.height/l.width;g(Math.round(e*i))}},H=e=>{if(g(e),u&&l.height>0){const i=l.width/l.height;r(Math.round(e*i))}},R=e=>{N(e),r(Math.round(l.width*e/100)),g(Math.round(l.height*e/100))},L=()=>{if(!o)return null;const e=document.createElement("canvas");e.width=m,e.height=c;const i=e.getContext("2d");return i?(i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.drawImage(o,0,0,m,c),e):null},T=()=>{const e=L();if(!e)return;const i=`image/${h}`,n=document.createElement("a");n.download=`resized-${m}x${c}.${h}`,n.href=e.toDataURL(i,p),n.click()},F=[{name:"HD",w:1280,h:720},{name:"Full HD",w:1920,h:1080},{name:"4K",w:3840,h:2160},{name:"Instagram",w:1080,h:1080},{name:"Twitter",w:1200,h:675},{name:"Facebook",w:1200,h:630},{name:"Thumbnail",w:150,h:150},{name:"Icon",w:64,h:64}],S=[25,50,75,100,150,200];return t("div",{className:"flex flex-col gap-4",children:[t("div",{className:"flex gap-2 flex-wrap items-center",children:[a(z,{onClick:()=>v.current?.click(),children:s(o?"tools.imageResizer.changeImage":"tools.imageResizer.selectImage")}),a("input",{ref:v,type:"file",accept:"image/*",onChange:$,className:"hidden"}),a(z,{variant:"secondary",onClick:T,disabled:!o,children:s("common.download")})]}),t("div",{className:"flex gap-4",children:[t("div",{className:"flex-1 flex flex-col gap-4",children:[a("div",{className:"flex justify-center p-4 bg-slate-100 rounded-lg min-h-[300px] overflow-auto",children:o?t("div",{className:"flex flex-col items-center gap-4",children:[a("img",{src:o.src,alt:"Preview",style:{maxWidth:"100%",maxHeight:300,width:"auto",height:"auto"},className:"shadow-lg rounded"}),t("div",{className:"text-sm text-slate-500",children:[s("tools.imageResizer.original"),": ",l.width,"\xD7",l.height," \u2192 ",s("tools.imageResizer.new"),": ",m,"\xD7",c]})]}):a("div",{className:"flex items-center justify-center text-slate-400",children:s("tools.imageResizer.placeholder")})}),t("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-2",children:s("tools.imageResizer.presets")}),a("div",{className:"grid grid-cols-4 md:grid-cols-8 gap-2",children:F.map(e=>t("button",{onClick:()=>{r(e.w),g(e.h),f(!1)},disabled:!o,className:"px-2 py-1.5 text-xs rounded border border-slate-200 hover:border-slate-300 disabled:opacity-50",children:[a("div",{className:"font-medium",children:e.name}),t("div",{className:"text-slate-400",children:[e.w,"\xD7",e.h]})]},e.name))})]})]}),t("div",{className:"w-64 border border-slate-200 rounded-lg bg-white p-4 flex flex-col gap-4",children:[a("h3",{className:"font-semibold text-slate-700",children:s("tools.imageResizer.settings")}),t("div",{className:"space-y-4",children:[t("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.imageResizer.mode")}),t("div",{className:"flex gap-1",children:[a("button",{onClick:()=>w("pixels"),className:`flex-1 px-2 py-1 text-xs rounded ${x==="pixels"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"}`,children:s("tools.imageResizer.pixels")}),a("button",{onClick:()=>w("percentage"),className:`flex-1 px-2 py-1 text-xs rounded ${x==="percentage"?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"}`,children:s("tools.imageResizer.percentage")})]})]}),x==="pixels"?t(y,{children:[t("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.imageResizer.width")}),a("input",{type:"number",min:"1",max:"10000",value:m,onChange:e=>E(parseInt(e.target.value)||1),className:"input w-full text-sm",disabled:!o})]}),t("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.imageResizer.height")}),a("input",{type:"number",min:"1",max:"10000",value:c,onChange:e=>H(parseInt(e.target.value)||1),className:"input w-full text-sm",disabled:!o})]}),t("label",{className:"flex items-center gap-2 text-sm",children:[a("input",{type:"checkbox",checked:u,onChange:e=>f(e.target.checked),className:"rounded"}),s("tools.imageResizer.lockRatio")]})]}):t(y,{children:[t("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-1",children:[s("tools.imageResizer.scale")," (",b,"%)"]}),a("input",{type:"range",min:"10",max:"300",value:b,onChange:e=>R(parseInt(e.target.value)),className:"w-full",disabled:!o})]}),a("div",{className:"grid grid-cols-3 gap-1",children:S.map(e=>t("button",{onClick:()=>R(e),disabled:!o,className:`px-2 py-1 text-xs rounded ${b===e?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,children:[e,"%"]},e))})]}),t("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:s("tools.imageResizer.format")}),a("div",{className:"flex gap-1",children:["png","jpeg","webp"].map(e=>a("button",{onClick:()=>I(e),className:`flex-1 px-2 py-1 text-xs rounded ${h===e?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"}`,children:e.toUpperCase()},e))})]}),h!=="png"&&t("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-1",children:[s("tools.imageResizer.quality")," (",Math.round(p*100),"%)"]}),a("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:p,onChange:e=>M(parseFloat(e.target.value)),className:"w-full"})]}),o&&t("div",{className:"pt-4 border-t border-slate-200",children:[a("h4",{className:"text-xs font-medium text-slate-500 mb-2",children:s("tools.imageResizer.info")}),t("div",{className:"space-y-1 text-xs text-slate-600",children:[t("div",{children:[s("tools.imageResizer.original"),": ",l.width,"\xD7",l.height]}),t("div",{children:[s("tools.imageResizer.new"),": ",m,"\xD7",c]}),t("div",{children:[s("tools.imageResizer.ratio"),": ",(m/l.width*100).toFixed(1),"%"]})]})]})]})]})]})]})}export{B as default};
