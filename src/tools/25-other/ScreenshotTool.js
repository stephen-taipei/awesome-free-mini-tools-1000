import{jsx as t,jsxs as a}from"react/jsx-runtime";import{useState as p,useRef as h,useEffect as M}from"react";import{useTranslation as B}from"react-i18next";import g from"../../components/ui/Button";function I(){const{t:l}=B(),N=h(null),b=h(null),v=h(null),[x,y]=p(null),[c,T]=p("html"),[f,k]=p(`<div style="padding: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-family: system-ui; border-radius: 12px;">
  <h1 style="margin: 0 0 16px 0;">Hello World!</h1>
  <p style="margin: 0; opacity: 0.9;">This is a sample content for screenshot.</p>
</div>`),[i,C]=p(null),[e,d]=p({format:"png",quality:92,scale:2,backgroundColor:"#ffffff",useTransparent:!1}),w=o=>{const s=o.target.files?.[0];if(!s)return;const r=new FileReader;r.onload=n=>{y(n.target?.result),T("image")},r.readAsDataURL(s)},S=async()=>{const o=b.current;if(o)try{const s=(await import("html2canvas")).default,r=await s(o,{scale:e.scale,backgroundColor:e.useTransparent?null:e.backgroundColor,useCORS:!0,logging:!1}),n=`image/${e.format}`,u=e.format==="png"?void 0:e.quality/100,m=r.toDataURL(n,u);C(m)}catch{const r=b.current;if(!r)return;const n=document.createElement("canvas"),u=r.getBoundingClientRect();n.width=u.width*e.scale,n.height=u.height*e.scale;const m=n.getContext("2d");if(!m)return;m.scale(e.scale,e.scale),m.fillStyle=e.useTransparent?"transparent":e.backgroundColor,m.fillRect(0,0,u.width,u.height);const E=`image/${e.format}`,L=e.format==="png"?void 0:e.quality/100,H=n.toDataURL(E,L);C(H)}},R=()=>{if(!i)return;const o=document.createElement("a");o.href=i,o.download=`screenshot-${Date.now()}.${e.format}`,o.click()},q=async()=>{if(i)try{const s=await(await fetch(i)).blob();await navigator.clipboard.write([new ClipboardItem({[s.type]:s})])}catch(o){console.error("Failed to copy to clipboard:",o)}};return M(()=>{c==="html"&&y(f)},[f,c]),a("div",{className:"flex flex-col gap-4",children:[a("div",{className:"flex gap-2 flex-wrap items-center",children:[t(g,{onClick:()=>T("html"),variant:c==="html"?"primary":"secondary",children:l("tools.screenshotTool.htmlMode")}),t(g,{onClick:()=>v.current?.click(),variant:c==="image"?"primary":"secondary",children:l("tools.screenshotTool.imageMode")}),t("input",{ref:v,type:"file",accept:"image/*",onChange:w,className:"hidden"}),t("div",{className:"flex-1"}),t(g,{onClick:S,children:l("tools.screenshotTool.capture")})]}),a("div",{className:"flex gap-4",children:[a("div",{className:"flex-1 flex flex-col gap-4",ref:N,children:[c==="html"&&a("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-2",children:l("tools.screenshotTool.htmlInput")}),t("textarea",{value:f,onChange:o=>k(o.target.value),className:"w-full h-32 p-3 font-mono text-sm border border-slate-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter HTML content..."})]}),a("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-2",children:l("tools.screenshotTool.preview")}),t("div",{className:"p-4 bg-slate-100 rounded-lg min-h-[200px] overflow-auto",style:{backgroundColor:e.useTransparent?"transparent":e.backgroundColor},children:t("div",{ref:b,className:"inline-block",style:{backgroundColor:e.useTransparent?"transparent":e.backgroundColor},children:c==="html"?t("div",{dangerouslySetInnerHTML:{__html:f}}):x?t("img",{src:x,alt:"Content",className:"max-w-full"}):t("div",{className:"text-slate-400 p-8",children:l("tools.screenshotTool.placeholder")})})})]}),i&&a("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-2",children:l("tools.screenshotTool.result")}),t("div",{className:"p-4 bg-slate-100 rounded-lg",children:t("img",{src:i,alt:"Screenshot",className:"max-w-full shadow-lg rounded"})}),a("div",{className:"flex gap-2 mt-2",children:[t(g,{onClick:R,variant:"secondary",children:l("tools.screenshotTool.download")}),t(g,{onClick:q,variant:"secondary",children:l("tools.screenshotTool.copyToClipboard")})]})]})]}),a("div",{className:"w-64 border border-slate-200 rounded-lg bg-white p-4 flex flex-col gap-4",children:[t("h3",{className:"font-semibold text-slate-700",children:l("tools.screenshotTool.settings")}),a("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-1",children:l("tools.screenshotTool.format")}),a("select",{value:e.format,onChange:o=>d({...e,format:o.target.value}),className:"w-full p-2 border border-slate-200 rounded text-sm",children:[t("option",{value:"png",children:"PNG"}),t("option",{value:"jpeg",children:"JPEG"}),t("option",{value:"webp",children:"WebP"})]})]}),e.format!=="png"&&a("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:[l("tools.screenshotTool.quality"),": ",e.quality,"%"]}),t("input",{type:"range",min:"10",max:"100",value:e.quality,onChange:o=>d({...e,quality:Number(o.target.value)}),className:"w-full"})]}),a("div",{children:[a("label",{className:"block text-xs text-slate-500 mb-1",children:[l("tools.screenshotTool.scale"),": ",e.scale,"x"]}),t("input",{type:"range",min:"1",max:"4",step:"0.5",value:e.scale,onChange:o=>d({...e,scale:Number(o.target.value)}),className:"w-full"})]}),t("div",{children:a("label",{className:"flex items-center gap-2 text-sm text-slate-600",children:[t("input",{type:"checkbox",checked:e.useTransparent,onChange:o=>d({...e,useTransparent:o.target.checked}),className:"rounded"}),l("tools.screenshotTool.transparent")]})}),!e.useTransparent&&a("div",{children:[t("label",{className:"block text-xs text-slate-500 mb-1",children:l("tools.screenshotTool.backgroundColor")}),a("div",{className:"flex gap-2",children:[t("input",{type:"color",value:e.backgroundColor,onChange:o=>d({...e,backgroundColor:o.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),t("input",{type:"text",value:e.backgroundColor,onChange:o=>d({...e,backgroundColor:o.target.value}),className:"flex-1 p-2 border border-slate-200 rounded text-sm font-mono"})]})]}),a("div",{className:"pt-4 border-t border-slate-200",children:[t("h4",{className:"text-xs font-medium text-slate-500 mb-2",children:l("tools.screenshotTool.tips")}),a("ul",{className:"text-xs text-slate-500 space-y-1",children:[a("li",{children:["\u2022 ",l("tools.screenshotTool.tip1")]}),a("li",{children:["\u2022 ",l("tools.screenshotTool.tip2")]}),a("li",{children:["\u2022 ",l("tools.screenshotTool.tip3")]})]})]})]})]})]})}export{I as default};
