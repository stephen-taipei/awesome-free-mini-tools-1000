import{jsx as l,jsxs as s}from"react/jsx-runtime";import{useState as g,useRef as v,useEffect as I}from"react";import{useTranslation as H}from"react-i18next";import x from"../../components/ui/Button";function $(){const{t:e}=H(),f=v(null),d=v(null),[a,h]=g(null),[o,c]=g(!1),[n,p]=g(!1),[b,N]=g("png"),[u,y]=g(.9),F=t=>{const i=t.target.files?.[0];if(!i)return;const r=new Image;r.onload=()=>{h(r),c(!1),p(!1)},r.src=URL.createObjectURL(i)};I(()=>{if(!a||!d.current)return;const t=d.current,i=t.getContext("2d");i&&(t.width=a.width,t.height=a.height,i.clearRect(0,0,t.width,t.height),i.save(),i.translate(o?t.width:0,n?t.height:0),i.scale(o?-1:1,n?-1:1),i.drawImage(a,0,0),i.restore())},[a,o,n]);const w=()=>{const t=d.current;if(!t)return;const i=`image/${b}`,r=[o?"h":"",n?"v":""].filter(Boolean).join("-")||"original",m=document.createElement("a");m.download=`flipped-${r}.${b}`,m.href=t.toDataURL(i,u),m.click()},k=async()=>{const t=d.current;if(t)try{const i=await new Promise(r=>{t.toBlob(m=>r(m),"image/png")});await navigator.clipboard.write([new ClipboardItem({"image/png":i})])}catch(i){console.error("Failed to copy:",i)}},C=()=>{c(!1),p(!1)};return s("div",{className:"flex flex-col gap-4",children:[s("div",{className:"flex gap-2 flex-wrap items-center",children:[l(x,{onClick:()=>f.current?.click(),children:e(a?"tools.imageFlipper.changeImage":"tools.imageFlipper.selectImage")}),l("input",{ref:f,type:"file",accept:"image/*",onChange:F,className:"hidden"}),s("div",{className:"flex gap-1",children:[l("button",{onClick:()=>c(!o),disabled:!a,className:`px-3 py-1.5 rounded ${o?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,title:e("tools.imageFlipper.flipHorizontal"),children:"\u21C6"}),l("button",{onClick:()=>p(!n),disabled:!a,className:`px-3 py-1.5 rounded ${n?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,title:e("tools.imageFlipper.flipVertical"),children:"\u21C5"})]}),l(x,{variant:"secondary",onClick:k,disabled:!a,children:e("common.copy")}),l(x,{variant:"secondary",onClick:w,disabled:!a,children:e("common.download")})]}),s("div",{className:"flex gap-4",children:[s("div",{className:"flex-1 flex flex-col gap-4",children:[l("div",{className:"flex justify-center p-4 bg-slate-100 rounded-lg min-h-[350px] overflow-auto",children:a?l("canvas",{ref:d,className:"max-w-full max-h-[350px] shadow-lg",style:{objectFit:"contain"}}):l("div",{className:"flex items-center justify-center text-slate-400 h-full",children:e("tools.imageFlipper.placeholder")})}),a&&l("div",{className:"text-center text-sm text-slate-500",children:e(o&&n?"tools.imageFlipper.flippedBoth":o?"tools.imageFlipper.flippedH":n?"tools.imageFlipper.flippedV":"tools.imageFlipper.noFlip")})]}),s("div",{className:"w-64 border border-slate-200 rounded-lg bg-white p-4 flex flex-col gap-4",children:[l("h3",{className:"font-semibold text-slate-700",children:e("tools.imageFlipper.settings")}),s("div",{className:"space-y-4",children:[s("div",{children:[l("label",{className:"block text-xs text-slate-500 mb-2",children:e("tools.imageFlipper.flipOptions")}),s("div",{className:"space-y-2",children:[s("label",{className:"flex items-center gap-2",children:[l("input",{type:"checkbox",checked:o,onChange:t=>c(t.target.checked),disabled:!a,className:"rounded"}),l("span",{className:"text-sm",children:e("tools.imageFlipper.flipHorizontal")})]}),s("label",{className:"flex items-center gap-2",children:[l("input",{type:"checkbox",checked:n,onChange:t=>p(t.target.checked),disabled:!a,className:"rounded"}),l("span",{className:"text-sm",children:e("tools.imageFlipper.flipVertical")})]})]})]}),s("div",{children:[l("label",{className:"block text-xs text-slate-500 mb-2",children:e("tools.imageFlipper.quickFlip")}),s("div",{className:"grid grid-cols-2 gap-1",children:[l("button",{onClick:()=>{c(!0),p(!1)},disabled:!a,className:`px-2 py-1.5 text-xs rounded ${o&&!n?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,children:e("tools.imageFlipper.horizontal")}),l("button",{onClick:()=>{c(!1),p(!0)},disabled:!a,className:`px-2 py-1.5 text-xs rounded ${!o&&n?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,children:e("tools.imageFlipper.vertical")}),l("button",{onClick:()=>{c(!0),p(!0)},disabled:!a,className:`px-2 py-1.5 text-xs rounded ${o&&n?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"} disabled:opacity-50`,children:e("tools.imageFlipper.both")}),l("button",{onClick:C,disabled:!a,className:"px-2 py-1.5 text-xs rounded bg-slate-100 hover:bg-slate-200 disabled:opacity-50",children:e("tools.imageFlipper.reset")})]})]}),s("div",{children:[l("label",{className:"block text-xs text-slate-500 mb-1",children:e("tools.imageFlipper.format")}),l("div",{className:"flex gap-1",children:["png","jpeg","webp"].map(t=>l("button",{onClick:()=>N(t),className:`flex-1 px-2 py-1 text-xs rounded ${b===t?"bg-blue-500 text-white":"bg-slate-100 hover:bg-slate-200"}`,children:t.toUpperCase()},t))})]}),b!=="png"&&s("div",{children:[s("label",{className:"block text-xs text-slate-500 mb-1",children:[e("tools.imageFlipper.quality")," (",Math.round(u*100),"%)"]}),l("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:u,onChange:t=>y(parseFloat(t.target.value)),className:"w-full"})]}),a&&s("div",{className:"pt-4 border-t border-slate-200",children:[l("h4",{className:"text-xs font-medium text-slate-500 mb-2",children:e("tools.imageFlipper.info")}),s("div",{className:"space-y-1 text-xs text-slate-600",children:[s("div",{children:[e("tools.imageFlipper.size"),": ",a.width,"\xD7",a.height]}),s("div",{children:[e("tools.imageFlipper.flipH"),": ",o?"\u2713":"\u2717"]}),s("div",{children:[e("tools.imageFlipper.flipV"),": ",n?"\u2713":"\u2717"]})]})]})]})]})]})]})}export{$ as default};
